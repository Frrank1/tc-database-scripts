SELECT c.component_name
     , cat.category_name as catalog
     , cat.category_id
     , (select name from project_category_lu where project_category_id = p.project_category_id) as phase_desc
     , p.project_id
     , ref_p.project_category_id
     , ref_p.project_category_id + 1111 as phase_id
     , pi1.scheduled_start_time as submission_start
     , pi1.scheduled_end_time as submission_end
     , pi3.scheduled_start_time as review_start
     , pi3.scheduled_end_time as review_end
     , pi4.scheduled_start_time as aggregation_start
     , pi4.scheduled_end_time as aggregation_end
     , pi5.scheduled_start_time as agg_review_start
     , pi5.scheduled_end_time as agg_review_end
     , pi6.scheduled_start_time as final_fix_start
     , pi6.scheduled_end_time as final_fix_end
     , pi7.scheduled_start_time as final_review_start
     , pi7.scheduled_end_time as final_review_end
     , pi8.scheduled_start_time as appeals_start
     , pi8.scheduled_end_time as appeals_end
     , pi3.scheduled_start_time  as screening_start
     , pi3.scheduled_end_time  as screening_end
     , null::DATETIME YEAR TO FRACTION as specification_submission_start
     , null::DATETIME YEAR TO FRACTION as specification_submission_end
     , null::DATETIME YEAR TO FRACTION as specification_review_start
     , null::DATETIME YEAR TO FRACTION as specification_review_end
     , cl.description as level
     , cvd.level_id
     , cv.version
     , cv.version_text
     , NVL(pi_prize.value,0)::FLOAT AS prize
     , pi3.scheduled_start_time as opens_on
     , exists (select * from project_phase where project_id = p.project_id and phase_type_id = 4 and phase_status_id in (2,3)) as open
     , (SELECT MIN(review_resp_id) from review_resp WHERE phase_id = p.project_category_id + 111) as reviewer_type_id
, NVL((SELECT user_id FROM rboard_application WHERE project_id = p.project_id AND primary_ind = 1), 0) as review_user_id
, NVL((SELECT u.handle FROM rboard_application ra, user u WHERE ra.project_id = p.project_id AND ra.primary_ind = 1 AND ra.user_id = u.user_id), '') as review_user_handle
FROM project p
     , comp_versions cv
     , project_phase pi1

     , project_phase pi3
     , project_phase pi4
     , project_phase pi5
     , project_phase pi6
     , project_phase pi7
     , project_phase pi8
     , comp_catalog c
     , categories cat
     , comp_version_dates cvd
     , comp_level cl
     , project_info pinfo
     , OUTER project_info pi_prize
     , linked_project_xref lpx
     , project ref_p
 WHERE p.project_id = pinfo.project_id
   AND pinfo.project_info_type_id = 1
   AND pinfo.value = cv.comp_vers_id
   AND p.project_id = pi1.project_id
   AND pi1.phase_type_id = 2
   AND p.project_id = pi3.project_id
   AND pi3.phase_type_id = 4
   AND p.project_id = pi4.project_id
   AND pi4.phase_type_id = 7
   AND p.project_id = pi5.project_id
   AND pi5.phase_type_id = 8
   AND p.project_id = pi6.project_id
   AND pi6.phase_type_id = 9
   AND p.project_id = pi7.project_id
   AND pi7.phase_type_id = 10
   AND p.project_id = pi8.project_id
   AND pi8.phase_type_id = 5
   AND p.project_id = @pj@
   AND c.component_id = cv.component_id
   AND c.root_category_id = cat.category_id
   AND cvd.comp_vers_id = cv.comp_vers_id
   AND cvd.phase_id = cv.phase_id
   AND cvd.level_id = cl.level_id
   AND p.project_id = pi_prize.project_id
   AND pi_prize.project_info_type_id = 35
   AND p.project_id = lpx.dest_project_id
   AND lpx.link_type_id = 3
   AND lpx.source_project_id = ref_p.project_id


union all 


SELECT c.component_name
     , cat.category_name as catalog
     , cat.category_id
     , (select name from project_category_lu where project_category_id = p.project_category_id) || ' Spec Review' as phase_desc
     , p.project_id
     , p.project_category_id
     , p.project_category_id + 1111 as phase_id
     , null::DATETIME YEAR TO FRACTION as submission_start
     , null::DATETIME YEAR TO FRACTION as submission_end
     , null::DATETIME YEAR TO FRACTION as review_start
     , null::DATETIME YEAR TO FRACTION as review_end
     , null::DATETIME YEAR TO FRACTION as aggregation_start
     , null::DATETIME YEAR TO FRACTION as aggregation_end
     , null::DATETIME YEAR TO FRACTION as agg_review_start
     , null::DATETIME YEAR TO FRACTION as agg_review_end
     , null::DATETIME YEAR TO FRACTION as final_fix_start
     , null::DATETIME YEAR TO FRACTION as final_fix_end
     , null::DATETIME YEAR TO FRACTION as final_review_start
     , null::DATETIME YEAR TO FRACTION as final_review_end
     , null::DATETIME YEAR TO FRACTION as appeals_start
     , null::DATETIME YEAR TO FRACTION as appeals_end
     , null::DATETIME YEAR TO FRACTION as screening_start
     , null::DATETIME YEAR TO FRACTION as screening_end
     , pi13.scheduled_start_time as specification_submission_start
     , pi13.scheduled_end_time as specification_submission_end
     , pi14.scheduled_start_time as specification_review_start
     , pi14.scheduled_end_time as specification_review_end
     , cl.description as level
     , cvd.level_id
     , cv.version
     , cv.version_text
     , 0 prize
     , pi13.scheduled_start_time as opens_on
     , exists (select * from project_phase where project_id = p.project_id and phase_type_id = 13 and phase_status_id in (2,3)) as open
     , (SELECT MIN(review_resp_id) from review_resp WHERE phase_id = p.project_category_id + 1111) as reviewer_type_id
, NVL((SELECT user_id FROM rboard_application WHERE project_id = p.project_id AND phase_id=p.project_category_id + 1111), 0) as review_user_id
, NVL((SELECT u.handle FROM rboard_application ra, user u WHERE ra.project_id = p.project_id AND
       ra.phase_id=p.project_category_id + 1111 AND ra.user_id = u.user_id), '') as review_user_handle
FROM project p
     , comp_versions cv
     , project_phase pi13
     , project_phase pi14
     , comp_catalog c
     , categories cat
     , comp_version_dates cvd
     , comp_level cl
     , project_info pinfo
 WHERE p.project_id = pinfo.project_id
   AND pinfo.project_info_type_id = 1
   AND pinfo.value = cv.comp_vers_id
   AND p.project_id = pi13.project_id
   AND pi13.phase_type_id = 13
   AND p.project_id = pi14.project_id
   AND pi14.phase_type_id = 14
   AND p.project_id = @pj@
   AND c.component_id = cv.component_id
   AND c.root_category_id = cat.category_id
   AND cvd.comp_vers_id = cv.comp_vers_id
   AND cvd.phase_id = cv.phase_id
   AND cvd.level_id = cl.level_id